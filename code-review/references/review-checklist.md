# Code Review 检查清单

## P0 - 错误（必须修复）

### TypeScript 类型安全
- [ ] 是否使用了 `as any` 或 `@ts-ignore`
- [ ] 是否有 `!` 非空断言滥用（应使用可选链或类型守卫）
- [ ] 函数参数和返回值是否有明确类型
- [ ] 泛型使用是否正确

### 逻辑错误
- [ ] 条件判断是否有遗漏分支
- [ ] 循环是否有终止条件
- [ ] 异步操作是否有错误处理（try/catch 或 .catch）
- [ ] 空值/undefined 是否有保护（`obj?.prop` vs `obj.prop`）
- [ ] 数组操作前是否检查了是否为数组（`Array.isArray`）

### React 特有
- [ ] useEffect 依赖数组是否完整
- [ ] useState 初始值类型是否正确
- [ ] 条件渲染中 `&&` 左侧是否可能为 `0`（应用 `!!` 或 `Boolean()`）
- [ ] 事件处理函数是否在 render 中创建新引用（应用 useCallback）

### Vue 3 特有
- [ ] reactive 对象是否被解构（丢失响应式）
- [ ] ref 在 script 中是否使用了 `.value`
- [ ] computed 是否有副作用（应无副作用）
- [ ] watch 的源是否正确（函数 vs 直接引用）

## P1 - 安全（必须修复）

- [ ] 是否有 `dangerouslySetInnerHTML` / `v-html` 未转义用户输入
- [ ] 是否有硬编码的密钥、Token、密码
- [ ] 是否有 `eval()`、`new Function()` 的使用
- [ ] 第三方库是否有已知安全漏洞
- [ ] URL 拼接是否有注入风险
- [ ] 是否有 `localStorage` 存储敏感信息

## P2 - 性能（建议修复）

### 渲染性能
- [ ] 大列表是否使用了虚拟滚动（>100 条）
- [ ] 组件是否有不必要的重渲染（检查 props 引用稳定性）
- [ ] 是否有昂贵计算未使用 useMemo/computed 缓存
- [ ] 图片是否有懒加载

### 内存与资源
- [ ] useEffect/onMounted 中的事件监听是否在清理函数中移除
- [ ] 定时器（setTimeout/setInterval）是否有清理
- [ ] WebSocket/EventSource 连接是否在组件卸载时关闭
- [ ] 大对象是否在不需要时释放

### 网络
- [ ] API 请求是否有防抖/节流（搜索、自动保存等场景）
- [ ] 相同数据是否有缓存机制（避免重复请求）
- [ ] 是否有请求竞态处理（AbortController 或取消令牌）

## P3 - 可维护性（建议改进）

- [ ] 函数是否超过 50 行（建议拆分）
- [ ] 组件是否超过 300 行（建议拆分）
- [ ] 是否有重复代码（>3 行相似代码出现 2+ 次）
- [ ] 变量/函数命名是否表达了意图
- [ ] 复杂逻辑是否有注释说明
- [ ] 魔术数字是否提取为常量
- [ ] 错误消息是否足够清晰（便于调试）

## P4 - 风格（可选改进）

- [ ] 是否遵循项目的 ESLint/Prettier 规则
- [ ] import 顺序是否规范（第三方 → 内部模块 → 相对路径）
- [ ] 文件命名是否符合项目规范
- [ ] 是否有无用的 console.log（开发调试残留）
- [ ] 是否有被注释掉的代码块（应删除或用 TODO 标记）
